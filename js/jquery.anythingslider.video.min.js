/*
 * AnythingSlider Video Controller 1.3 beta minified
 * for AnythingSlider v1.6+
 * By Rob Garrison (aka Mottie & Fudgey)
 * Dual licensed under the MIT and GPL licenses.
 */

(function(a){a.fn.anythingSliderVideo=function(b){var c={videoID:"asvideo"};return this.each(function(){var f,e,d,h,g=a(this).data("AnythingSlider");if(!g){return}f=g.video={};f.options=a.extend({},c,b);f.hasSwfo=(typeof(swfobject)!=="undefined"&&swfobject.hasOwnProperty("embedSWF")&&typeof(swfobject.embedSWF)==="function"&&swfobject.hasFlashPlayerVersion("1"));f.list={};f.hasVid=false;f.hasEmbed=false;f.services=a.fn.anythingSliderVideo.services;f.len=0;f.hasEmbedCount=0;f.hasiframeCount=0;f.$items=g.$items.filter(":not(.cloned)");for(d in f.services){if(typeof(d)==="string"){h=f.services[d].selector;f.$items.find(h).each(function(){e=a(this);e.attr("id",f.options.videoID+f.len);f.list[f.len]={id:f.options.videoID+f.len++,panel:e.closest(".panel")[0],service:d,selector:h,status:-1};f.hasVid=true;if(h.match("embed|object")){f.hasEmbed=true;f.hasEmbedCount++}else{if(h.match("iframe")){f.hasiframeCount++}}})}}a.each(f.list,function(m,q){var n,k,r,j,l=a(q.panel).find(q.selector),p=f.services[q.service],o=p.initAPI||"";if(f.hasEmbed&&f.hasSwfo&&q.selector.match("embed|object")){l.each(function(){k=(a(this).parent()[0].tagName==="OBJECT")?a(this).parent():a(this);r=(k[0].tagName==="EMBED")?k.attr("src"):k.find("embed").attr("src")||k.children().filter("[name=movie]").attr("value");j=a.extend(true,{},{flashvars:null,params:{allowScriptAccess:"always",wmode:g.options.addWmodeToObject,allowfullscreen:true},attr:{"class":k.attr("class"),style:k.attr("style"),"data-url":r}},p.embedOpts);k.wrap('<div id="'+q.id+'"></div>');swfobject.embedSWF(r+(o===""?"":o+q.id),q.id,k.attr("width"),k.attr("height"),"10",null,j.flashvars,j.params,j.attr,function(){if(p.hasOwnProperty("init")){f.list[m].player=p.init(g,q.id,m)}if(m>=f.hasEmbedCount){g.$el.trigger("swf_completed",g)}})})}else{if(q.selector.match("iframe")){l.each(function(t,s){r=a(this).attr("src");n=(r.match(/\?/g)?"":"?")+"&wmode="+g.options.addWmodeToObject;a(this).attr("src",function(u,v){return v+n+(o===""?"":o+q.id)})})}}});f.gup=function(k,i){k=k.replace(/[\[]/,"\\[").replace(/[\]]/,"\\]");var j=(new RegExp("[\\?&]"+k+"=([^&#]*)")).exec(i||window.location.href);return(j===null)?"":j[1]};f.postMsg=function(k,i){var j=a("#"+i);if(j.length){j[0].contentWindow.postMessage(k,j.attr("src").split("?")[0])}};f.message=function(j){if(j.data){if(/infoDelivery/g.test(j.data)){return}var i=a.parseJSON(j.data);a.each(f.list,function(k,l){if(f.services[f.list[k].service].hasOwnProperty("message")){f.services[f.list[k].service].message(g,i)}})}};f.control=function(k){var l,m=f.list,j=(k==="pause")?g.$lastPage[0]:g.$currentPage[0],n=false;for(l=0;l<f.len;l++){if(m[l].panel===j&&f.services[m[l].service].hasOwnProperty(k)){n=f.services[m[l].service][k](g,m[l].id,l)}}return n};if(f.hasiframeCount){if(window.addEventListener){window.addEventListener("message",f.message,false)}else{window.attachEvent("onmessage",f.message,false)}}g.$el.bind("slide_init",function(){f.control("pause")}).bind("slide_complete",function(){f.control("cont")});g.options.isVideoPlaying=function(){return f.control("isPlaying")}})};a.fn.anythingSliderVideo.services={video:{selector:"video",cont:function(e,b,d){var c=a("#"+b);if(c.length&&c[0].paused&&c[0].currentTime>0&&!c[0].ended){c[0].play()}},pause:function(c,b){a("video").each(function(){if(typeof(this.pause)!=="undefined"){this.pause()}})},isPlaying:function(e,b,d){var c=a("#"+b);return(c.length&&typeof(c[0].pause)!=="undefined"&&!c[0].paused&&!c[0].ended)?true:false}},vimeo1:{selector:"iframe[src*=vimeo]",initAPI:"&api=1&player_id=",cont:function(d,b,c){if(d.options.resumeOnVisible&&d.video.list[c].status==="pause"){d.video.postMsg('{"method":"play"}',b)}},pause:function(c,b){a("iframe[src*=vimeo]").each(function(){c.video.postMsg('{"method":"pause"}',this.id)})},message:function(e,d){var c,b=d.player_id||"";if(b!==""){c=b.replace(e.video.options.videoID,"");if(d.event==="ready"){e.video.postMsg('{"method":"addEventListener","value":"play"}',b);e.video.postMsg('{"method":"addEventListener","value":"pause"}',b);e.video.postMsg('{"method":"addEventListener","value":"finish"}',b)}if(e.video.list[c]){e.video.list[c].status=d.event}}},isPlaying:function(d,b,c){return(d.video.list[c].status==="play")?true:false}},vimeo2:{selector:"object[data-url*=vimeo], embed[src*=vimeo]",embedOpts:{flashvars:{api:1}},cont:function(e,b,d){if(e.options.resumeOnVisible){var c=a("#"+b);if(typeof(c[0].api_play)==="function"&&c[0].api_paused()&&c[0].api_getCurrentTime()!==0&&(c[0].api_getDuration()-c[0].api_getCurrentTime())>2){c[0].api_play()}}},pause:function(c,b){a("object[data-url*=vimeo], embed[src*=vimeo]").each(function(){var d=(this.tagName==="EMBED")?a(this).parent()[0]:this;if(typeof(d.api_pause)==="function"){d.api_pause()}})},isPlaying:function(e,b,d){var c=a("#"+b);return(typeof(c[0].api_paused)==="function"&&!c[0].api_paused())?true:false}},youtube1:{selector:"iframe[src*=youtube]",initAPI:"&iv_load_policy=3&enablejsapi=1&playerapiid=",cont:function(d,b,c){if(d.options.resumeOnVisible&&d.video.list[c].status===2){d.video.postMsg('{"event":"command","func":"playVideo"}',b)}},pause:function(d,b,c){a("iframe[src*=youtube]").each(function(){d.video.postMsg('{"event":"command","func":"pauseVideo"}',b)})},message:function(g,f){if(f.event==="infoDelivery"){return}if(f.info&&f.info.videoUrl){var e=g.video.gup("v",f.info.videoUrl),c=a("iframe[src*="+e+"]"),b,d;if(c.length){b=c[0].id;d=b.replace(g.video.options.videoID,"");if(f.event==="onReady"){g.video.postMsg('{"event":"listening","func":"onStateChange"}',b)}if(f.event==="onStateChange"&&g.video.list[d]){g.video.list[d].status=f.info.playerState}}}},isPlaying:function(e,b,d){var c=e.video.list[d].status;return(c===1||c>2)?true:false}},youtube2:{selector:"object[data-url*=youtube], embed[src*=youtube]",initAPI:"&iv_load_policy=3&enablejsapi=1&version=3&playerapiid=",cont:function(e,b,d){if(e.options.resumeOnVisible){var c=a("#"+b);if(c.length&&typeof(c[0].getPlayerState)==="function"&&c[0].getPlayerState()>0){c[0].playVideo()}}},pause:function(c,b){a("object[data-url*=youtube], embed[src*=youtube]").each(function(){var d=(this.tagName==="EMBED")?a(this).parent()[0]:this;if(typeof(d.getPlayerState)==="function"&&d.getPlayerState()>0){d.pauseVideo()}})},isPlaying:function(d,b){var c=a("#"+b);return(typeof(c[0].getPlayerState)==="function"&&(c[0].getPlayerState()===1||c[0].getPlayerState()>2))?true:false}}}})(jQuery);jQuery(window).load(function(){jQuery(".anythingBase").anythingSliderVideo()});
